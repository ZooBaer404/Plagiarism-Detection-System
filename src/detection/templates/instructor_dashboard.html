{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<!-- =========================================
     LOAD PAGE-SPECIFIC STYLESHEET
     ========================================= -->
<link rel="stylesheet" href="{% static 'css/instructor_dashboard.css' %}">
{% endblock %}

{% block content %}
<!-- =========================================================
     PAGE: Instructor Dashboard
     DESCRIPTION:
       Main control panel for instructors.
       Includes overview boxes for:
         - Previous Checks
         - Submissions
         - Repository Access
         - File Upload (for plagiarism checking)
   ========================================================= -->

<div class="instructor-dashboard-container h-full bg-[#faf9f7] text-black flex flex-col overflow-y-auto">

  <!-- =========================================
       HEADER SECTION
       ========================================= -->
  <header class="instructor-header flex justify-between p-2">
    <!-- Logo/Title -->
    <a href="{% url 'instructor_dashboard' %}" class="brand-title text-4xl">Plagiarism Detection</a>

    <!-- Page Title -->
    <h1 class="page-title text-2xl">Instructor Dashboard</h1>

    <!-- Profile Icon -->
    <a href="{% url 'instructor_account' %}" class="profile-icon border-2 p-2" title="Account Info">
      <span>I</span>
    </a>
  </header>

  <!-- =========================================
       DASHBOARD GRID LAYOUT
       ========================================= -->
  <main class="dashboard-grid border-2 flex-1 p-2 grid grid-cols-2 grid-rows-1 gap-2">

    <!-- =========================================
         LEFT COLUMN
         Includes:
           1. Previous Checks
           2. Submissions
       ========================================= -->
    <section class="left-col flex flex-col gap-2 border-2 border-neutral-700 p-1">

      <!-- Previous Checks -->
      <h2 class="text-2xl"><a href="{% url 'instructor_checks' %}">Previous Checks</a></h2>
      
      <div class="flex flex-col gap-2 overflow-y-auto">
        {% for check in previous_checks %}
          <div class="check-item border-2 border-neutral-700 p-2">
            <strong>{{ check.checking_document_name }} ({{check.created_at}} - {{check.created_at|timesince}} ago)</strong>
            <p>Checked: {{ check.report_result|floatformat:2 }}%</p>
          </div>
        {% endfor %}
      </div>

    </section>

    <!-- =========================================
         RIGHT COLUMN
         Upload Area (File submission for check)
         * JS handles file selection & generate button
       ========================================= -->
    <section class="right-col flex flex-col border-2 border-neutral-700 justify-center items-center gap-5">
      <h3 class="text-3xl">Upload for Check</h3>

      <!-- File Upload Form -->
      <form id="uploadForm" method="POST" enctype="multipart/form-data" action="{% url 'instructor_dashboard' %}" class="flex flex-col gap-10 justify-center items-center">
        {% csrf_token %}

        <!-- File Input -->
        <input type="file" id="fileInput" class="file-input border-2 border-neutral-700 px-5" name="document" accept=".pdf">
        {% comment %} <label for="fileInput" class="upload-btn">Choose File</label> {% endcomment %}

        <!-- Generate Button (revealed via JS) -->
        <button type="submit" id="generateBtn" class="generate-btn border-2 border-neutral-700 pl-20 pr-20">Generate Report</button>
      </form>
    </section>

  </main>
</div>
{% endblock %}
